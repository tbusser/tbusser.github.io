!function(e,t){"function"==typeof define&&define.amd?define("CardDeck",[],t):"object"==typeof exports?module.exports=t():e.CardDeck=t()}(this,function(){var e=function(){this._deck=[]};return e.prototype={_getSuitName:function(e){switch(e){case 0:return"clubs";case 1:return"diamonds";case 2:return"hearts";default:return"spades"}},_getValueSymbol:function(e){switch(e){case 11:return"J";case 12:return"Q";case 13:return"K";case 14:return"A";default:return e}},getCards:function(e){return 0>e?[]:(e=Math.min(e,this._deck.length),this._deck.slice(0,e))},init:function(){for(var e=0;4>e;e++)for(var t=this._getSuitName(e),i=2;15>i;i++){var n=this._getValueSymbol(i);this._deck.push({suit:t,value:i,symbol:n})}},shuffle:function(){for(var e,t,i,n,s,r=this._deck.length-1,a=!1;r>=0;){s=0;do e=Math.random()*r|0,i=this._deck[e],s++;while(i.value===n&&r>=s);a=a||s>r&&i.value===n,n=i.value,t=this._deck[r],this._deck[r]=i,this._deck[e]=t,r--}return!a}},e}),function(e,t){"function"==typeof define&&define.amd?define("Mediator",[],t):"object"==typeof exports?module.exports=t():e.Mediator=t()}(this,function(){function e(t){for(var i in t._channels)t._channels.hasOwnProperty(i)&&(e(t._channels[i]),delete t._channels[i]);t.removeSubscriber()}function t(e,t){if(null==e||""===e)return null;for(var i=a,n=e.split(":"),s=0,r=n.length;r>s&&null!=i;){if(i.hasChannel(n[s]))i=i.returnChannel(n[s]);else{if(t)break;i=i.addChannel(n[s])}s++}return""===i.namespace?null:i}function i(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function n(e,t){return e.options.priority>t.options.priority?-1:e.options.priority<t.options.priority?1:0}function s(e,t,n){this.id=i(),this.callback=e,this.context=t,this.options=n,this.channel=null}function r(e,t,i){this.namespace=e||"",this.id=i,this._subscribers=[],this._channels={},this._parent=t,this._stopped=!1}r.prototype={addChannel:function(e){var t=(""===this.namespace?"":this.namespace+":")+e,i=new r(t,this,e);return this._channels[e]=i,i},addSubscriber:function(e,t,i){null==i&&(i={}),i.priority=null==i.priority?0:0|i.priority;var r=new s(e,t,i);return r.channel=this,this._subscribers.push(r),this._subscribers.sort(n),r},autoRemoveChannel:function(){if(0===this._subscribers.length){for(var e in this._channels)if(this._channels.hasOwnProperty(e))return;null!=this._parent&&this._parent.removeChannel(this.id)}},hasChannel:function(e){return this._channels.hasOwnProperty(e)},publish:function(e){for(var t=0,i=this._subscribers.length,n=i;i>t;){var s=!1,r=this._subscribers[t],a=r.options;s=null!=a&&null!=a.predicate?a.predicate.apply(r.context,e):!0,s&&(null!=a&&null!=a.calls&&(a.calls--,a.calls<1&&this.removeSubscriber(r.id)),r.callback.apply(r.context,e),this._subscribers.length!=n&&(t-=n-this._subscribers.length,n=i=this._subscribers.length)),t++}null!=this._parent&&this._parent.publish(e)},removeChannel:function(e){this.hasChannel(e)&&(this._channels[e]=null,delete this._channels[e],this.autoRemoveChannel())},removeSubscriber:function(e){var t=!1,i=0,n=0;if(null==e){for(i=0,n=this._subscribers.length;n>i;i++)this._subscribers[i].channel=null;this._subscribers=[],t=!0}else for(i=this._subscribers.length-1;i>=0&&!t;)this._subscribers[i].id===e&&(this._subscribers[i].channel=null,t=!0,this._subscribers.splice(i,1)),i--;return this.autoRemoveChannel(),t},returnChannel:function(e){return this._channels[e]},returnSubscriber:function(e){for(var t,i=this._subscribers.length-1;i>=0&&null==t;)this._subscribers[i].id===e&&(t=this._subscribers[i]),i--;return t},setSubscriberPriority:function(e,t){var i=this.returnSubscriber(e);return null==i?!1:(i.options.priority=0|t,this._subscribers.sort(n),!0)}};var a=new r("");return{getSubscriber:function(e,i){var n=t(e,!0);return null==n||n.namespace!==e?null:n.returnSubscriber(i)},once:function(e,t,i,n){return n=n||{},n.calls=1,this.subscribe(e,t,i,n)},publish:function(e){var i=t(e,!0);if(null==i)return null;var n=Array.prototype.slice.call(arguments,1);n.push(e),n.push(i),i.publish(n)},reset:function(){e(a)},setSubscriberPriority:function(e,i,n){var s=t(e,!0);return null==s||s.namespace!=e?null:s.setSubscriberPriority(i,n)},subscribe:function(e,i,n,s){var r=t(e,!1);return null==r||r.namespace!=e?null:(n=n||{},s=s||{},r.addSubscriber(i,n,s).id)},unsubscribe:function(e,i){var n=t(e,!0);return null==n||n.namespace!==e?null:n.removeSubscriber(i)}}}),function(e,t){"function"==typeof define&&define.amd?define("Deck",["CardDeck","Mediator"],t):"object"==typeof exports?module.exports=t(require("CardDeck","Mediator")):e.Deck=t(e.CardDeck,e.Mediator)}(this,function(e,t){var i=function(e){this._element=e};return i.prototype={_onTransitionEnd:function(e){var i=e.currentTarget;i.removeEventListener("transitionend",this._transitionEndHandler),i.style.zIndex=parseInt(i.getAttribute("data-zindex"),10),t.publish("cardOpened",null)},_setTransformStyle:function(e,t){e.style.mozTransform=t,e.style.msTransform=t,e.style.webkitTransform=t,e.style.transform=t},_rotateCard:function(e,t,i){this._setTransformStyle(e,"rotateY("+t+"deg)"),this._setTransformStyle(e.querySelector(".card-face__back"),"rotateZ("+i+"deg)"),this._setTransformStyle(e.querySelector(".card-face__front"),"rotateY(180deg) rotateZ("+-i+"deg)")},_shuffleDeck:function(){var e=0,t=!1;do e++,t=this._cardDeck.shuffle();while(!t&&100>e);console.log("deck shuffled, attempts: "+e)},getDeckSize:function(){return null===this._cards?0:this._cards.length},init:function(){this._cards=this._element.querySelectorAll(".card"),null!==this._cards&&0!==this._cards.length&&(this._cardDeck=new e,this._cardDeck.init(),this._transitionEndHandler=this._onTransitionEnd.bind(this))},openTopCard:function(){if(this._openCards>=this._cards.length)return null;var e=this._cards.length-++this._openCards,t=this._cards[e];if(null==t)return null;t.addEventListener("transitionend",this._transitionEndHandler);var i=0|t.getAttribute("data-rotation"),n="card--"+this._gameDeck[e].suit;return t.setAttribute("data-suit",n),t.classList.add(n),t.querySelector(".card-face__front").innerHTML=this._gameDeck[e].symbol,this._rotateCard(t,180,-i),this._gameDeck[e]},reset:function(){this._cards=this._element.querySelectorAll(".card"),this._shuffleDeck(),this._gameDeck=this._cardDeck.getCards(this._cards.length);for(var e=0,t=this._cards.length;t>e;e++){var i=18*Math.random()-9|0,n=this._cards[e],s=n.querySelector(".card-face__front");n.setAttribute("data-zindex",t-e),n.setAttribute("data-rotation",i),n.style.zIndex=e===t-1?1:60,this._rotateCard(n,0,i),n.classList.remove(n.getAttribute("data-suit")),null!=s&&(s.innerHTML="")}this._openCards=0}},i}),function(e,t){"function"==typeof define&&define.amd?define("Player",["Mediator"],t):"object"==typeof exports?module.exports=t(require("Mediator")):e.Player=t(e.Mediator)}(this,function(e){function t(e,t){for(var i in e)e.hasOwnProperty(i)&&t(i,e[i])}var i=function(){this._statistics={balance:-1,currentStreak:0,gamesPlayed:0,longestLosingStreak:0,longestWinningStreak:0,perfectLosses:0,perfectWins:0,wonLastGame:!0},Object.defineProperty(this,"balance",{get:function(){return this._statistics.balance},set:function(){throw new Error("The property balance on the Player object is read-only")}}),Object.defineProperty(this,"currentStreak",{get:function(){return this._statistics.currentStreak},set:function(){throw new Error("The property currentStreak on the Player object is read-only")}}),Object.defineProperty(this,"gamesPlayed",{get:function(){return this._statistics.gamesPlayed},set:function(){throw new Error("The property gamesPlayed on the Player object is read-only")}}),Object.defineProperty(this,"isOnWinningStreak",{get:function(){return this._statistics.wonLastGame},set:function(){throw new Error("The property isOnWinningStreak on the Player object is read-only")}}),Object.defineProperty(this,"longestLosingStreak",{get:function(){return this._statistics.longestLosingStreak},set:function(){throw new Error("The property longestLosingStreak on the Player object is read-only")}}),Object.defineProperty(this,"longestWinningStreak",{get:function(){return this._statistics.longestWinningStreak},set:function(){throw new Error("The property longestWinningStreak on the Player object is read-only")}}),Object.defineProperty(this,"perfectLosses",{get:function(){return this._statistics.perfectLosses},set:function(){throw new Error("The property perfectLosses on the Player object is read-only")}}),Object.defineProperty(this,"perfectWins",{get:function(){return this._statistics.perfectWins},set:function(){throw new Error("The property perfectWins on the Player object is read-only")}})};return i.prototype={_gameFinished:function(){switch(this._statistics.gamesPlayed++,e.publish("achievement:criteria:updated",{id:["gamesPlayed5","gamesPlayed10"],value:this.gamesPlayed}),this.longestWinningStreak){case 5:e.publish("achievement:criteria:met",{id:"winStreak5"});break;case 10:e.publish("achievement:criteria:met",{id:"winStreak10"})}this.balance>=100&&e.publish("achievement:criteria:met",{id:"rich"})},_setBalance:function(t){t!=this._statistics.balance&&(this._statistics.balance=t,e.publish("balanceUpdated",{value:t}))},getStatusObject:function(){return this._statistics},init:function(e){var i=this;null!=e?t(e,function(e,t){null!=i._statistics[e]&&("balance"===e?i._setBalance(t):i._statistics[e]=t)}):t(this._statistics,function(e){switch(e){case"balance":i._setBalance(20);break;case"wonLastGame":i._statistics.wonLastGame=!0;break;default:i._statistics[e]=0}})},playerLost:function(t,i){this._setBalance(this.balance-t),this.isOnWinningStreak?(this._statistics.currentStreak=0,this._statistics.wonLastGame=!1):(this._statistics.currentStreak++,this._statistics.longestLosingStreak=Math.max(this.longestLosingStreak,this.currentStreak)),e.publish("gameLost",{streak:this.currentStreak}),i&&(this._statistics.perfectLosses++,1===this._statistics.perfectLosses&&e.publish("achievement:criteria:met",{id:"perfectLoss"})),this._gameFinished()},playerWon:function(t,i){this._setBalance(this.balance+t),this.isOnWinningStreak?(this._statistics.currentStreak++,this._statistics.longestWinningStreak=Math.max(this.longestWinningStreak,this.currentStreak)):(this._statistics.currentStreak=0,this._statistics.wonLastGame=!0),e.publish("gameWon",{streak:this.currentStreak}),i&&(this._statistics.perfectWins++,1===this._statistics.perfectWins&&e.publish("achievement:criteria:met",{id:"perfectWin"})),this._gameFinished()}},i}),function(e,t){"function"==typeof define&&define.amd?define("Achievements",["Mediator"],t):"object"==typeof exports?module.exports=t(require("Mediator")):e.Achievements=t(e.Mediator)}(this,function(e){function t(e,t){for(var i in e)e.hasOwnProperty(i)&&t(i,e[i])}var i=function(){this._options=i.options,this._criteriaMetId=null,this._criteriaUpdatedId=null,this._initialized=!1,this._unlockedPoints=0,this._totalPoints=0,Object.defineProperty(this,"isInitialized",{get:function(){return this._initialized},set:function(){throw new Error("The property isInitialized on the Achievements object is read-only")}}),Object.defineProperty(this,"totalPoints",{get:function(){return this._totalPoints},set:function(){throw new Error("The property totalPoints on the Achievements object is read-only")}}),Object.defineProperty(this,"unlockedPoints",{get:function(){return this._unlockedPoints},set:function(){throw new Error("The property unlockedPoints on the Achievements object is read-only")}})};return i.options={hiddenDescription:"Keep playing to discover this achievement",hiddenTitle:"Hidden"},i.prototype={_callbackAchievementCriteria:function(e,t){switch(t){case"achievement:criteria:met":this._onAchievementCriteriaMet(e);break;case"achievement:criteria:updated":this._onAchievementCriteriaUpdated(e)}},_renderAchievement:function(e,t,i){var n=document.createElement("li");n.id="achievement-"+i,n.classList.add("achievement");var s=document.createElement("h2"),r=document.createElement("p"),a="("+t.points+(1===t.points?" point)":" points)");return s.setAttribute("data-subtitle",a),s.classList.add("achievement__title"),r.classList.add("achievement__description"),t.hidden&&!t.unlocked?(s.innerHTML=this._options.hiddenTitle,r.innerHTML=this._options.hiddenDescription):(s.innerHTML=t.title,r.innerHTML=t.description),n.appendChild(s),n.appendChild(r),null==t.predicate||t.unlocked||this._renderProgressIndicator(n),e.appendChild(n),n},_renderProgressIndicator:function(e){var t=document.createElement("article"),i=document.createElement("div");return t.classList.add("progress-indicator"),i.classList.add("progress-indicator__value"),t.appendChild(i),e.appendChild(t),t},_setProgressIndicator:function(e,t){var i=0;50>t?(i=90+3.6*t+"deg",e.style.backgroundImage="linear-gradient(90deg, #ccc 50%, transparent 50%, transparent), linear-gradient("+i+", steelblue 50%, #ccc 50%, #ccc)"):(i=-90+3.6*(t-50)+"deg",e.style.backgroundImage="linear-gradient("+i+", steelblue 50%, transparent 50%, transparent), linear-gradient(270deg, steelblue 50%, #ccc 50%, #ccc)")},_onAchievementCriteriaMet:function(e){var t=this._achievements[e.id];null==t||t.unlocked||this._unlockAchievement(t)},_onAchievementCriteriaUpdated:function(t){var i=[];if("string"==typeof t.id)i.push(t.id);else{if(!Array.isArray(t.id))return;i=t.id.slice(0)}for(var n=0,s=i.length;s>n;n++){var r=this._achievements[i[n]];null!=r&&(r.value=t.value,r.value===r.predicate&&this._unlockAchievement(r))}e.publish("achievement:updated",{achievement:t.id})},_unlockAchievement:function(t){t.unlocked||(t.unlocked=!0,this._unlockedPoints+=t.points,e.publish("achievement:unlocked",{achievement:t,unlockedPoints:this._unlockedPoints,totalPoints:this._totalPoints}))},destroy:function(){this._initialized&&(null!=this._callbackId&&e.unsubscribe("achievement:criteria",this._callbackId),this._callbackId=null,this._achievements=null,this._totalPoints=this._unlockedPoints=0,this._initialized=!1)},getAchievementValue:function(e){var t=this._achievements[e];return null==t||null==t.value?0:t.value},getStatusObject:function(){var e={};return t(this._achievements,function(t,i){(null!=i.unlocked||null!=i.value)&&(e[t]={unlocked:i.unlocked,value:i.value})}),e},init:function(i){if(!this._initialized){this._achievements=i||{};var n=this;this._totalPoints=this._unlockedPoints=0,t(this._achievements,function(e,t){n._totalPoints+=t.points,t.unlocked&&(n._unlockedPoints+=t.points)}),this._callbackId=e.subscribe("achievement:criteria",this._callbackAchievementCriteria,this),this._initialized=!0}},renderAchievementList:function(e){var i=this;t(this._achievements,function(t,n){var s=document.getElementById("achievement-"+t),r=null,a=null,o=null;if(null==s&&(s=i._renderAchievement(e,n,t)),n.unlocked&&s.classList.contains("achievement--locked"))s.classList.remove("achievement--locked"),null==n.predicate?s.classList.contains("achievement__lock")&&s.classList.remove("achievement__lock"):(r=s.querySelector(".progress-indicator"),null!=r&&(r.parentNode.removeChild(r),r=null)),n.hidden&&(o=s.querySelector(".achievement__title"),a=s.querySelector(".achievement__description"),null!=o&&(o.innerHTML=n.title),null!=a&&(a.innerHTML=n.description));else if(!n.unlocked)if(s.classList.contains("achievement--locked")||(s.classList.add("achievement--locked"),n.hidden&&(o=s.querySelector(".achievement__title"),a=s.querySelector(".achievement__description"),null!=o&&(o.innerHTML=i._options.hiddenTitle),null!=a&&(a.innerHTML=i._options.hiddenDescription))),null==n.predicate)s.classList.contains("achievement__lock")||s.classList.add("achievement__lock");else{r=s.querySelector(".progress-indicator"),null==r&&(r=i._renderProgressIndicator(s));var l=r.querySelector(".progress-indicator__value");if(null!=l){var c=n.value/n.predicate*100|0;i._setProgressIndicator(r,c),l.innerHTML=c+"%"}}})}},i}),function(e,t){"function"==typeof define&&define.amd?define("Notification",[],t):"object"==typeof exports?module.exports=t():e.Notification=t()}(this,function(){function e(e,t){for(var i in e)e.hasOwnProperty(i)&&t(i,e[i])}function t(t,i){return e(i,function(e,i){t.hasOwnProperty(e)&&(t[e]=i)}),t}var i=function(e,n){this._element=e,this._options=t(i.options,n),this._initialized=!1,this._isVisible=!1,this._queue=[],this._transitionEndHandler=this._onTransitionEndHandler.bind(this),null!=e&&(this._title=e.querySelector(this._options.titleSelector),this._message=e.querySelector(this._options.messageSelector),this._initialized=null!=this._title&&null!=this._message)};return i.options={messageSelector:".notification__description",showClass:"notification--show",timeout:3500,titleSelector:".notification__title"},i.prototype={_makeVisible:function(e,t,i,n){this._title.innerHTML=e,null==i||""===i?this._title.removeAttribute("data-subtitle"):this._title.setAttribute("data-subtitle",i),this._message.innerHTML=t,null!=n&&(this._element.setAttribute("data-classname",n),this._element.classList.add(n)),this._element.classList.add(this._options.showClass),setTimeout(this._onTimeout.bind(this),this._options.timeout)},_onTimeout:function(){this._element.addEventListener("transitionend",this._transitionEndHandler),this._element.classList.remove(this._options.showClass)},_onTransitionEndHandler:function(){if(this._element.removeEventListener("transitionend",this._transitionEndHandler),this._queue.length>0){var e=this._queue[0];this._queue=this._queue.slice(1),this._makeVisible(e.title,e.message,e.subTitle,e.cssClass)}else this._element.hasAttribute("data-classname")&&(this._element.classList.remove(this._element.getAttribute("data-classname")),this._element.removeAttribute("data-classname")),this._isVisible=!1},_onShowNotificationHandler:function(e){this.showNotification(e.title,e.message,e.subTitle,e.cssClass)},clearQueue:function(){this._queue=[]},init:function(e){this._initialized&&null!=e&&(this._notificationHandler=this._onShowNotificationHandler.bind(this),e.subscribe("showNotification",this._notificationHandler,this))},showNotification:function(e,t,i,n){return this._isVisible?(this._queue.push({cssClass:n,title:e,message:t,subTitle:i}),!1):(this._isVisible=!0,this._makeVisible(e,t,i,n),!0)}},i}),function(e,t){"function"==typeof define&&define.amd?define("Spinner",[],t):"object"==typeof exports?module.exports=t():e.Spinner=t()}(this,function(){var e=function(e){this._element=e};return e.prototype={_initSpinner:function(e){var t=e.querySelector(".spinner__button--increase"),i=e.querySelector(".spinner__button--decrease"),n=e.querySelector("input");null!=t&&t.hasAttribute("data-for")&&null!=document.getElementById(t.getAttribute("data-for"))&&t.addEventListener("click",this._onClickHandlerIncrease.bind(this)),null!=i&&i.hasAttribute("data-for")&&null!=document.getElementById(i.getAttribute("data-for"))&&i.addEventListener("click",this._onClickHandlerDecrease.bind(this)),null!=n&&n.addEventListener("blur",this._onBlurHandlerInput.bind(this))},_onBlurHandlerInput:function(e){var t=e.currentTarget,i=0|t.value,n=0|t.getAttribute("min"),s=0|t.getAttribute("max");i>s?t.value=s:n>i&&(t.value=n)},_onClickHandlerDecrease:function(e){var t=document.getElementById(e.currentTarget.getAttribute("data-for"));if(null!=t){var i=(0|t.value)-1;if(t.hasAttribute("min")){var n=0|t.getAttribute("min");if(n>i)return}t.value=i}},_onClickHandlerIncrease:function(e){var t=document.getElementById(e.currentTarget.getAttribute("data-for"));if(null!=t){var i=(0|t.value)+1;if(t.hasAttribute("max")){var n=0|t.getAttribute("max");if(i>n)return}t.value=i}},init:function(){for(var e=this._element.querySelectorAll(".spinner"),t=0,i=e.length;i>t;t++)this._initSpinner(e[t])}},e}),function(e,t){"function"==typeof define&&define.amd?define("StakesTable",["Mediator","Spinner"],t):"object"==typeof exports?module.exports=t(require("Mediator","Spinner")):e.StakesTable=t(e.Mediator,e.Spinner)}(this,function(e,t){var i=function(e){this._element=e};return i.prototype={_onClickHandlerStartGame:function(){e.publish("startGame",{rightGuesses:0|this._inputGuess.value,betAmount:0|this._inputBet.value})},init:function(){this._inputGuess=document.getElementById("inputRightGuesses"),this._inputBet=document.getElementById("inputBetAmount");var e=this._element.querySelector(".control-button__start");null!=e&&e.addEventListener("click",this._onClickHandlerStartGame.bind(this));var i=new t(this._element);i.init()}},i}),function(e,t){"function"==typeof define&&define.amd?define("PlayTable",["Mediator"],t):"object"==typeof exports?module.exports=t(require("Mediator")):e.PlayTable=t(e.Mediator)}(this,function(e){var t=function(e){this._element=e,this._enabled=!0,this._intialized=!1,Object.defineProperty(this,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e,this._intialized&&(this._buttonOver.disabled=this._buttonUnder.disabled=!e)}})};return t.prototype={_onClickHandlerOver:function(){e.publish("guessMade",{guessedOver:!0})},_onClickHandlerUnder:function(){e.publish("guessMade",{guessedOver:!1})},init:function(){this._buttonOver=document.getElementById("btnGuessOver"),null!=this._buttonOver&&this._buttonOver.addEventListener("click",this._onClickHandlerOver.bind(this)),this._buttonUnder=document.getElementById("btnGuessUnder"),null!=this._buttonUnder&&this._buttonUnder.addEventListener("click",this._onClickHandlerUnder.bind(this)),this._intialized=null!=this._buttonOver&&null!=this._buttonUnder}},t}),function(e,t){"function"==typeof define&&define.amd?define("LocalStorage",[],t):"object"==typeof exports?module.exports=t():e.LocalStorage=t()}(this,function(){function e(e){try{return JSON.parse(e)}catch(t){return e}}function t(e){return JSON.stringify(e)}var i=function(){this._enabled=!0,this.testAvailability(),Object.defineProperty(this,"enabled",{get:function(){return this._initialized&&this._enabled},set:function(e){this._enabled=e}}),Object.defineProperty(this,"isAvailable",{get:function(){return this._initialized},set:function(){throw new Error("The property isAvailable on the LocalStorage object is read-only")}})};return i.prototype={clear:function(){if(this.isAvailable)try{localStorage.clear()}catch(e){this._initialized=!1}return this._initialized},get:function(t){if(!this.isAvailable)return null;try{return e(localStorage.getItem(t))}catch(i){return this._initialized=!1,null}},remove:function(e){if(this.isAvailable)try{localStorage.removeItem(e)}catch(t){this._initialized=!1}return this._initialized},set:function(e,i){if(!this.isAvailable)return!1;if(null==i)return this.remove(e);try{localStorage.setItem(e,t(i))}catch(n){this._initialized=!1}return this._initialized},testAvailability:function(){var e="__lsp__";try{localStorage.setItem(e,e),this._initialized=localStorage.getItem(e)===e,localStorage.removeItem(e)}catch(t){this._initialized=!1}return this._initialized}},i}),function(e,t){"function"==typeof define&&define.amd?define("StatsTable",["Mediator"],t):"object"==typeof exports?module.exports=t(require("Mediator")):e.StatsTable=t(e.Mediator)}(this,function(e){var t=function(e){this._element=e};return t.prototype={_updateBalance:function(e,t,i){var n=e+(i?1:-1),s=this;this._setInnerHTML(this._valueBalance,n),n!=t&&setTimeout(function(){s._updateBalance(n,t,i)},100)},_callbackBalanceChanged:function(e){if(null!=this._valueBalance){var t=parseInt(this._valueBalance.innerHTML,10),i=t<e.value;isNaN(t)?this._setInnerHTML(this._valueBalance,e.value):this._updateBalance(t,e.value,i)}},_callbackCardPlayed:function(e){this._setInnerHTML(this._valueIndex,e.cardsPlayed),this._setInnerHTML(this._valueGuessesRight,e.rightGuesses)},_callbackStartGame:function(e){this._setInnerHTML(this._valueGuessesTarget,"/ "+e.rightGuesses),this._setInnerHTML(this._valueIndex,0),this._setInnerHTML(this._valueGuessesRight,0)},_setInnerHTML:function(e,t){null!=e&&(e.innerHTML=t)},init:function(){this._valueBalance=document.getElementById("valueBalance"),this._valueIndex=document.getElementById("valueIndex"),this._valueGuessesRight=document.getElementById("valueRightGuess"),this._valueGuessesTarget=document.getElementById("valueTargetGuesses"),e.subscribe("balanceUpdated",this._callbackBalanceChanged.bind(this),this),e.subscribe("startGame",this._callbackStartGame.bind(this),this),e.subscribe("cardPlayed",this._callbackCardPlayed.bind(this),this)}},t}),function(e,t){"function"==typeof define&&define.amd?define("SettingsView",["Mediator"],t):"object"==typeof exports?module.exports=t(require("Mediator")):e.SettingsView=t(e.Mediator)}(this,function(e){var t=function(e){this._element=e};return t.prototype={_onClickHandlerButton:function(){e.publish("resetGameData")},init:function(){var e=document.getElementById("btnReset");null!=e&&e.addEventListener("click",this._onClickHandlerButton.bind(this))}},t}),define("game",["Deck","Player","Achievements","Mediator","Notification","StakesTable","PlayTable","LocalStorage","StatsTable","SettingsView"],function(e,t,i,n,s,r,a,o,l,c){function u(e){var t="("+e.achievement.points+(1==e.achievement.points?" point)":" points)");n.publish("showNotification",{cssClass:"notification--achievement",message:e.achievement.description,subTitle:t,title:e.achievement.title}),z++,L.achievementUnlocked(e.unlockedPoints,e.totalPoints,z)}function d(){G.enabled=!0,n.publish("cardPlayed",{cardsPlayed:w.cardsPlayed-1,rightGuesses:w.correctGuesses}),w.cardsPlayed>=H.getDeckSize()&&S()}function h(){q.destroy(),q.init(JSON.parse(D)),C.init(),T.isAvailable&&(T.set(E,q.getStatusObject()),T.set(A,C.getStatusObject())),n.publish("showNotification",{title:"Game data reset",message:"All your progress has been reset",cssClass:"notification--settings"})}function f(){var e=document.getElementById("js-elevator");null!=e&&e.classList.remove("elevator--card-deck")}function m(e){k(e.guessedOver)}function _(e){w.cardsPlayed=1,w.correctGuesses=0,w.handsToGuess=e.rightGuesses,w.betAmount=e.betAmount;var t=document.getElementById("js-elevator");null!=t&&(t.addEventListener("transitionend",g),t.classList.add("elevator--card-deck"))}function p(){T.isAvailable&&(T.set(E,q.getStatusObject()),T.set(A,C.getStatusObject()))}function b(){var e=document.getElementById("js-elevator");null!=e&&(e.classList.contains("elevator--achievements")?e.classList.remove("elevator--achievements"):(e.classList.contains("elevator--settings")&&e.classList.remove("elevator--settings"),x.classList.contains("control-button--counter-indicator")&&(x.classList.remove("control-button--counter-indicator"),x.removeAttribute("data-counter"),z=0),q.renderAchievementList(document.getElementById("achievementsList")),e.classList.add("elevator--achievements")))}function v(){var e=document.getElementById("js-elevator");null!=e&&(e.classList.contains("elevator--achievements")&&e.classList.remove("elevator--achievements"),e.classList.toggle("elevator--settings"))}function g(e){e.currentTarget.removeEventListener("transitionend",g),H.reset(),w.lastCard=H.openTopCard(),G.enabled=!0}function y(){}function k(e){G.enabled=!1;var t=H.openTopCard();w.cardsPlayed++,t&&w.lastCard&&(t.value<w.lastCard.value?e||w.correctGuesses++:e&&w.correctGuesses++),w.lastCard=t}function S(){G.enabled=!1;var e=w.betAmount*(w.handsToGuess-4)+Math.abs(w.correctGuesses-w.handsToGuess),t=w.correctGuesses===H.getDeckSize()-1||0===w.correctGuesses;w.correctGuesses>=w.handsToGuess?(C.playerWon(e,t),L.showResultText("You win!")):(C.playerLost(e,t),L.showResultText("You lose!",!0))}var L=null,T=new o,P=new l,w={betAmount:0,cardsPlayed:0,correctGuesses:0,handsToGuess:0,lastCard:null},E="over-under:achievements",A="over-under:player";P.init();var C=new t,I=null;T.isAvailable&&(I=T.get(A)),C.init(I),console.log(C.getStatusObject()),I=null;var M=document.querySelector(".deck"),H=null;if(null!=M){H=new e(M),H.init(),n.subscribe("cardOpened",d,this),M=null;var B=null,j=document.getElementById("stakesTable");if(null!=j){B=new r(j),B.init(),n.subscribe("startGame",_,this),j=null;var O=document.getElementById("playTable"),G=null;if(null!=O){G=new a(O),G.init(),n.subscribe("guessMade",m,this),O=null;var x=document.getElementById("achievements"),q=null,z=0,D='{"gamesPlayed10":{"description":"You have played 10 games. Is that a monkey on your back?","points":5,"predicate":10,"title" : "Addicted"},"gamesPlayed5":{"description":"You have played 5 games. Taking a break?","points":1,"predicate":5,"title" : "Taking A Break"},"perfectLoss":{"description":"Not getting a single guess right is a rare feat","hidden" : true,"points":10,"title":"Utter Defeat"},"perfectWin":{"description":"You have scored a perfect game, not a single wrong guess","hidden" : true,"points":10,"title":"Perfection"},"rich":{"description":"A 100 credits in the bank","points":10,"title":"They see me rollin\'..."},"winStreak10":{"description":"Wow, winning 10 games in a row is a sign of great skill!","points":10,"title":"Very Lucky"},"winStreak5":{"description":"Winning 5 games in a row is no small feat","points":5,"title":"Lucky"}}',W=null;if(null!=x){if(x.addEventListener("click",b),q=new i,W=JSON.parse(D),T.isAvailable){var N=T.get(E);if(null!=N){for(var U in N)N.hasOwnProperty(U)&&null!=W[U]&&(W[U].unlocked=N[U].unlocked,W[U].value=N[U].value);N=null}}q.init(W),W=null,n.subscribe("achievement:unlocked",u,this);var R=document.getElementById("notification"),V=null;if(null!=R){V=new s(R),V.init(n),R=null;var Y=document.getElementById("btnSettings"),J=null;null!=Y&&(Y.addEventListener("click",v),J=new c,J.init(),n.subscribe("resetGameData",h,this)),Y=null,window.addEventListener("beforeunload",p),y.prototype={constructor:y,_onClickHandlerAchievements:function(){var e=document.getElementById("js-elevator");null!=e&&(e.classList.toggle("elevator--achievements"),this._achievementsController.renderAchievementList(document.getElementById("achievementsList")))},_onTransitionEndMessage:function(){this._messageElem.removeEventListener("transitionend",this._messageTransitionEndHandler),this._messageElem.classList.add("game-result--hidden"),n.publish("gameResultTextRemoved")},_setTransformStyle:function(e,t){e.style.mozTransform=t,e.style.msTransform=t,e.style.webkitTransform=t,e.style.transform=t},achievementUnlocked:function(e,t,i){var n=document.getElementById("achievements");null!=n&&(n.setAttribute("data-counter",i),n.classList.add("control-button--counter-indicator")),this.updatePointsLabel(e,t)},init:function(e){this._achievements=e,this._messageElem=document.querySelector(".game-result"),this._messageTransitionEndHandler=this._onTransitionEndMessage.bind(this),this.updatePointsLabel(q.unlockedPoints,q.totalPoints)},showResultText:function(e,t){t?this._messageElem.classList.add("game-result--negative"):this._messageElem.classList.remove("game-result--negative"),this._messageElem.innerHTML=e,this._messageElem.addEventListener("transitionend",this._messageTransitionEndHandler),this._messageElem.classList.remove("game-result--hidden")},updatePointsLabel:function(e,t){var i=document.getElementById("achievementsUnlockedPoints"),n=document.getElementById("achievementsTotalPoints");null!=i&&(i.innerHTML=e),null!=n&&(n.innerHTML=t)}},L=new y,L.init(achievements),n.subscribe("gameResultTextRemoved",f,this)}}}}}});